# **Basic Subsystems and Commands**

Subsystems are how we organize our code in an frc codebase. They store motors and sensors, hold command factories, and much more! Typically each major mechanism will be seperated into a seperate class for ease of use. Subsystems also handle interrupts. When two commands try to use a subsystem at the same time, which ever command uses it last will get prority and the other command will get interrupted.

## **Parts of a Subsystem**

### **1\. Motors and Sensors**

* Subsystems are responsible for storing motors and sensors used on the robot
* Subsystem methods dictate how the the program interacts with a mechanisms electronics

### **2\. perodic()**

* Called repeatedly (typically every robot cycle, e.g., every 20ms) by the Command Scheduler
* Often used for logging telemetry data about what is going on in the subsystem
* Also used for mechanisms that need to hold their position by constantly sending control requests

### **2\. Command Factories**

* Generate commands for the rest of the robot code to use
* Built using the runOnce, run, etc. subsystem factories that come from inheriting SubsystemBase

## **Coding our First Subsystem**
Its finally time to get coding! In this section were going to create a simple roller subsystem like what we saw on the 2025 kitbot. It will extend SubsystemBase, hold a simple pwm motor controller, and have command factories for spinning and stopping the roller.

<figure markdown="span">
    ![2025 Kitbot](https://andymark.com/cdn/shop/files/am-KitBot25_1_1200x600_crop_center.jpg?v=1749943780){ width="400" }
  <figcaption>The 2025 Kitbot featuring a roller subsystem</figcaption>
</figure>

First create a new folder called ```Subsystems```. In that folder create a file called ```RollerSubsystem.java```. Then put the following code in the file:
```java
package frc.robot.Subsystems;

import edu.wpi.first.wpilibj.motorcontrol.Talon;
import edu.wpi.first.wpilibj2.command.Command;
import edu.wpi.first.wpilibj2.command.SubsystemBase;

public class RollerSubsystem extends SubsystemBase {
    private Talon motorController;

    public RollerSubsystem() {
        motorController = new Talon(1);
    }

    public Command startRollersCommand() {
        return runOnce(() -> motorController.set(1.0));
    }

    public Command stopRollersCommand() {
        return runOnce(() -> motorController.set(0.0));
    }
}

```
Lets walk through this code line by line to see what we can learn.

First we see that this class inherits from the ```SubsystemBase``` class and creates a constructor for our class. The ```SubsystemBase``` class provides many of the subsystem specific command factories (```runOnce()```) and other useful tools to make out programming experience easier.

Then we see this block of code:
```java
private Talon motorController;

public RollerSubsystem() {
    motorController = new Talon(1);
}
```
This creates a Talon motor controller on PWM channel 1. The Talon motor controller is rarely used in FRC today but it works based off a PWM signal suppied by the roborio. Channel 1 means our motor is plugged into the 1st channel of the roborio pinout. The Talon motor controller acts as our interface with the actual hardware allowing us to control the speed easily through code.

Then we see the next two functions of the class:
```java
public Command startRollersCommand() {
    return runOnce(() -> motorController.set(1.0));
}

public Command stopRollersCommand() {
    return runOnce(() -> motorController.set(0.0));
}
```
These two functions are command generators. The first one, ```startRollersCommand()``` generates a Command that sets the motor controller speed to 1.0. This is done through the runOnce function supplied by the SubsystemBase class. By using runOnce we can pass in a function, or lambda in this case, and it will automatically asign create a command that runs that function on initalize. It will also include our subsystem as a mechanism requirement allowing the command to make and recieve interrupts from the command scheduler. We do the same with the ```stopRollersCommand()``` except we set the speed to 0.0.

Now we have sucessfully coded our first subsystem! Next lesson will focus on how we trigger those command with user input.